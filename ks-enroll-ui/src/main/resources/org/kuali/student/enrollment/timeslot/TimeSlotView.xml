<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:p="http://www.springframework.org/schema/p"
       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd">

    <!--
        The Manage Time Slot FormView.
    -->
    <bean id="TimeSlot-View" parent="KS-Uif-FormView"
             p:id="timeSlotView"
             p:entryPageId="timeSlotPage"
             p:viewHelperServiceClass="org.kuali.student.enrollment.class1.timeslot.service.impl.TimeSlotViewHelperServiceImpl"
             p:formClass="org.kuali.student.enrollment.class1.timeslot.form.TimeSlotForm" >

             <property name="headerText" value="Time Slots" />
             <property name="header.cssClasses">
                 <list merge="true">
                     <value>uif-viewHeader</value>
                 </list>
             </property>

             <!-- Shows up in HTML so devs can find the code -->
             <property name="viewSourceFile" value="TimeSlotView.xml" />

             <property name="authorizer">
                 <bean class="org.kuali.student.enrollment.main.view.KsViewAuthorizerBase"/>
             </property>

             <property name="footer">
                 <bean parent="Uif-FooterBase"/>
             </property>

             <property name="additionalScriptFiles">
                 <list merge="true">
                     <value>themes/ksboot/scripts/toolbar.js</value>
                 </list>
             </property>

             <property name="breadcrumbOptions.homewardPathBreadcrumbs">
                 <list>
                     <ref bean="KS-HomewardPathBreadcrumbs-Home"/>
                     <ref bean="KS-HomewardPathBreadcrumbs-Enrollment"/>
                 </list>
             </property>

             <property name="items">
                 <list>
                     <ref bean="TimeSlot-Page" />
                 </list>
             </property>
             <property name="dialogs">
                 <list>
                 </list>
             </property>
         </bean>

    <bean id="TimeSlot-Page" parent="KS-Uif-Page" p:disclosure.render="false" p:id="timeSlotPage">
        <property name="items">
            <list>
                <bean parent="Uif-VerticalBoxSection">
                    <property name="items">
                        <list>
                            <ref bean="TimeSlotTypeSelect-Section" />
                            <ref bean="TimeSlotToolBar-Section" />
                            <ref bean="TimeSlotSearchResults-Section"  />
                            <ref bean="KS-TimeSlot-AddTimeSlotPopupForm"/>
                        </list>
                    </property>
                </bean>
            </list>
        </property>
    </bean>

    <bean id="TimeSlotTypeSelect-Section" parent="Uif-HorizontalBoxSection">
        <property name="items">
            <list>
                <!-- The multi-select drop-down -->
                <bean parent="Uif-VerticalBoxGroup">
                    <property name="items">
                        <list>
                            <bean parent="Uif-InputField" p:propertyName="termTypeSelections"  p:width="auto"
                                  p:label="Select Term Type(s) To Edit" p:labelPlacement="TOP">
                                <property name="control">
                                    <bean parent="Uif-MultiSelectControl" p:size="3" p:style="width:17em;"/>
                                </property>
                                <property name="optionsFinder">
                                    <bean class="org.kuali.student.enrollment.class1.timeslot.keyvalue.TermSlotTypeValues" p:addBlankOption="false"/>
                                </property>
                            </bean>
                            <bean parent="Uif-Message" p:messageText="Use 'ctrl' or 'shift' to select multiple" />
                        </list>
                    </property>
                </bean>
                <!--The submit button -->
                <bean parent="Uif-PrimaryActionButton"
                    p:performClientSideValidation="false" p:actionLabel="Show Time Slots" p:methodToCall="show" p:style="margin-top:20px;"/>
            </list>
        </property>
    </bean>

    <bean id="TimeSlotToolBar-Section" parent="KS-Uif-HorizontalBoxSection-ToolbarSection">
        <property name="items">
            <list>
                <bean parent="KS-Uif-HorizontalBoxGroup-ToolbarGroup" p:noLeftBorder="true">
                    <property name="items">
                        <list>
                            <bean id="TimeSlot-ToolBar-Add-TimeSlot" parent="TimeSlot-ToolBar-Add-Button-parent" p:disabled="@{!enableAddButton}"/>
                            <bean id="TimeSlot-ToolBar-Delete-TimeSlot" parent="TimeSlot-ToolBar-Delete-Button-parent"  p:methodToCall="deleteTimeSlots" />
                        </list>
                    </property>
                </bean>
            </list>
        </property>
    </bean>

    <bean id="TimeSlotSearchResults-Section" parent="Uif-VerticalBoxSection" >
        <property name="items">
            <list>
               <bean parent="Uif-Message" p:messageText="Time Slots For: @{termTypeSelections}" p:style="font-weight:bold;"/>
               <ref bean="TimeSlotSearchResults-TableCollectionSection" />
            </list>
        </property>
    </bean>

    <bean id="TimeSlotSearchResults-TableCollectionSection" parent="KS-Uif-TableCollectionSection-WithActionSeperator" p:renderAddLine="false"
        p:onDocumentReadyScript="resetCheckboxes('TimeSlotSearchResultsDisplayCheckBoxes');">
        <property name="id" value="TimeSlotSearchResultsDisplayCheckBoxes" />
        <property name="collectionObjectClass" value="org.kuali.student.enrollment.class1.timeslot.dto.TimeSlotWrapper" />
        <property name="propertyName" value="timeSlotResults" />
        <property name="collectionLookup">
            <bean parent="Uif-CollectionQuickFinder" p:quickfinderAction.render="false" />
        </property>
        <property name="layoutManager.renderSequenceField" value="false" />
        <property name="layoutManager.applyDefaultCellWidths" value="false" />
        <property name="layoutManager.applyAlternatingRowStyles" value="false" />
        <property name="layoutManager.richTable.emptyTableMessage" value="[No Term Types Have Been Selected]"/>
        <property name="layoutManager.richTable.render" value="true" />
        <property name="layoutManager.richTable.templateOptions">
            <map merge="true">
                <entry key="sDom" value="rtip"/>
                <entry key="aaSorting" value="[[ 1, 'asc' ]]"/>
                <entry key="bPaginate" value="false"/>
                <entry key="bAutoWidth" value="false"/>
            </map>
        </property>
        <property name="items">
            <list>
                <bean parent="Uif-InputField" p:propertyName="isChecked" p:required="false" p:hidden="@{!#line.isEnableDeleteButton()}"
                      p:onChangeScript="handleToolbar('TimeSlotSearchResultsDisplayCheckBoxes',['enableDeleteButton'], ['TimeSlot-ToolBar-Delete-TimeSlot']);">
                      <property name="control">
                            <bean parent="Uif-CheckboxControl" p:disabled="false"/>
                      </property>
                </bean>
                <bean parent="KS-Uif-DataField-Simple"
                                     p:label="Code"
                                     p:propertyName="timeSlotInfo.name"/>
                <bean parent="KS-Uif-DataField-Simple"
                    p:label="Term Type"
                    p:propertyName="typeName"/>
                <bean parent="KS-Uif-DataField-Simple"
                    p:label="Days"
                    p:propertyName="daysDisplayName"/>
                <bean parent="KS-Uif-DataField-Simple"
                    p:label="Start Time"
                    p:propertyName="startTimeDisplay"/>
                <bean parent="KS-Uif-DataField-Simple"
                    p:label="End Time"
                    p:propertyName="endTimeDisplay"/>
                <bean name="enableDeleteButton" parent="KS-Uif-DataField-Simple" p:label="enableDeleteButton"  p:propertyName="enableDeleteButton"/>
            </list>
        </property>
        <property name="layoutManager.richTable.hiddenColumns">
            <set>
                <value>enableDeleteButton</value>
            </set>
        </property>

        <property name="layoutManager.actionFieldPrototype">
            <bean parent="Uif-HorizontalFieldGroup" p:align="left" p:required="false" p:label="Actions"/>
        </property>
        <property name="lineActions">
            <list>
                <bean parent="Uif-NavigationActionLink"
                    p:methodToCall="edit"
                    p:actionLabel="Edit"
                    p:actionEvent="editCOonManageCOsPage">
                </bean>
            </list>
        </property>
    </bean>

    <!--
        Toolbar buttons
    -->
    <bean id="TimeSlot-ToolBar-Add-Button-parent" parent="KS-Uif-ToolBar-Button">
             <property name="actionLabel" value="Add Time Slot"/>
             <property name="actionScript" value="openPopupContent(e,'KS-TimeSlot-AddTimeSlotPopupForm');"/>
             <property name="actionImage">
                 <bean parent="Uif-Image" p:source="@{#parent.disabled ? #ConfigProperties['ks.externalizable.images.url']+'/toolbar/add_disabled.png' : #ConfigProperties['ks.externalizable.images.url']+'/toolbar/add_enabled.png'}"/>
             </property>
         </bean>

    <bean id="TimeSlot-ToolBar-Delete-Button-parent" parent="KS-Uif-ToolBar-Button">
        <property name="actionLabel" value="Delete"/>
        <property name="actionImage">
            <bean parent="Uif-Image" p:source="@{#parent.disabled ? #ConfigProperties['ks.externalizable.images.url']+'/toolbar/delete_disabled.png' : #ConfigProperties['ks.externalizable.images.url']+'/toolbar/delete_enabled.png'}"/>
        </property>
    </bean>


    <bean id="KS-TimeSlot-AddTimeSlotPopupForm" parent="Uif-HorizontalBoxSection">
        <property name="hidden" value="true"/>
        <property name="cssClasses">
            <list>
                <value>uif-bubblepopup-content</value>
            </list>
        </property>
        <property name="style" value="margin-bottom:0;padding-left:10px;padding-right:10px;"/>
        <property name="items">
            <list>
                <bean parent="Uif-InputField-LabelTop" p:propertyName="addOrEditTermKey" p:label="Term Type" p:required="true" >
                    <property name="control">
                        <bean parent="Uif-DropdownControl"/>
                    </property>
                    <property name="optionsFinder">
                        <bean class="org.kuali.student.enrollment.class1.timeslot.keyvalue.TimeSlotTypeOptionsFinder" p:addBlankOption="false" />
                    </property>
                </bean>
                <bean parent="Uif-InputField-LabelTop"  p:propertyName="addOrEditDays" p:label="Days" p:required="true">
                    <property name="control">
                        <bean parent="Uif-TextControl" p:size="10"  p:maxLength="7"/>
                    </property>
                </bean>
                <bean parent="Uif-InputField-LabelTop"  p:propertyName="addOrEditStartTime" p:label="Start Time">
                    <property name="control">
                        <bean parent="Uif-TextControl" p:size="5"  p:maxLength="5"/>
                    </property>
                    <property name="constraintText" value="HH:MM"/>
                    <property name="validCharactersConstraint">
                        <bean parent="TimePatternConstraint" />
                    </property>
                </bean>
                <bean parent="Uif-InputField-LabelTop" p:label="&lt;br&gt;" p:propertyName="addOrEditStartTimeAmPm" p:required="true">
                    <property name="fieldLabel.requiredMessage.messageText" value=""/>
                    <property name="control">
                        <bean parent="Uif-DropdownControl" p:options-ref="AmPm-Options" p:cssClasses="new_rdl_components"/>
                    </property>
                </bean>
                <bean parent="Uif-InputField-LabelTop"  p:propertyName="addOrEditEndTime" p:label="End Time">
                    <property name="control">
                        <bean parent="Uif-TextControl" p:size="5"  p:maxLength="5"/>
                    </property>
                    <property name="constraintText" value="HH:MM"/>
                    <property name="validCharactersConstraint">
                        <bean parent="TimePatternConstraint" />
                    </property>
                </bean>
                <bean parent="Uif-InputField-LabelTop" p:label="&lt;br&gt;" p:propertyName="addOrEditEndTimeAmPm" p:required="true">
                    <property name="fieldLabel.requiredMessage.messageText" value=""/>
                    <property name="control">
                        <bean parent="Uif-DropdownControl" p:options-ref="AmPm-Options" p:cssClasses="new_rdl_components"/>
                    </property>
                </bean>

                <bean parent="Uif-SecondaryActionButton-Small" >
                    <property name="cssClasses">
                        <list merge="true">
                            <value>ks_toolbar_popup_action_button</value>
                        </list>
                    </property>
                    <property name="actionLabel" value="Add Slot"/>
                    <property name="successCallback" value="jQuery('div[id=KS-TimeSlot-AddTimeSlotPopupForm]:gt(0)').detach();"/>
                    <property name="errorCallback" value="jQuery('div[id=KS-TimeSlot-AddTimeSlotPopupForm]:gt(0)').detach();"/>
                    <property name="methodToCall" value="createTimeSlot"/>
                </bean>
            </list>
        </property>
    </bean>

</beans>